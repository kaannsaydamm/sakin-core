id: suspicious-dns-response
name: Suspicious DNS Activity Response
description: Investigates and responds to suspicious DNS queries
enabled: true
version: "1.0"
steps:
  - id: notify-analyst
    action: notify_slack
    parameters:
      channel: "#threat-intel"
      message: "üîç Suspicious DNS activity detected: {{alert.normalized.metadata.domain}} queried from {{alert.source_ip}}"
  
  - id: create-investigation-ticket
    condition: "high_severity"
    action: create_jira_ticket
    parameters:
      summary: "Investigation Required: Suspicious DNS Query to {{alert.normalized.metadata.domain}}"
      description: |
        Suspicious DNS activity has been detected that requires investigation.
        
        Alert Details:
        - Alert ID: {{alert.id}}
        - Source IP: {{alert.source_ip}}
        - Domain: {{alert.normalized.metadata.domain}}
        - Query Type: {{alert.normalized.metadata.query_type}}
        - Rule: {{alert.rule_name}}
        - Severity: {{alert.severity}}
        - Timestamp: {{alert.triggered_at}}
        
        Next Steps:
        - Analyze the domain reputation
        - Check other systems that may have accessed this domain
        - Determine if this is part of a larger campaign
  
  - id: email-security-team
    condition: "high_severity"
    action: send_email
    parameters:
      to: "security-team@company.com,threat-intel@company.com"
      subject: "URGENT: Suspicious DNS Activity Investigation Required"
      body: |
        <h2>Suspicious DNS Activity Detected</h2>
        
        <p>A suspicious DNS query has been detected that requires immediate investigation:</p>
        
        <ul>
          <li><strong>Domain:</strong> {{alert.normalized.metadata.domain}}</li>
          <li><strong>Source IP:</strong> {{alert.source_ip}}</li>
          <li><strong>Query Type:</strong> {{alert.normalized.metadata.query_type}}</li>
          <li><strong>Alert ID:</strong> {{alert.id}}</li>
          <li><strong>Rule:</strong> {{alert.rule_name}}</li>
          <li><strong>Severity:</strong> {{alert.severity}}</li>
          <li><strong>Timestamp:</strong> {{alert.triggered_at}}</li>
        </ul>
        
        <p>A Jira ticket has been created for this investigation. Please review and take appropriate action.</p>
        
        <p><em>This alert was generated by SAKIN SOAR automation.</em></p>