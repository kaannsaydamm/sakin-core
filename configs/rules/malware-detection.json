{
  "id": "malware-detection",
  "name": "Malware Detection Based on Process Behavior",
  "description": "Detects potential malware based on suspicious process execution patterns",
  "enabled": true,
  "severity": "critical",
  "triggers": [
    {
      "type": "event",
      "eventType": "process_execution"
    }
  ],
  "conditions": [
    {
      "field": "process_name",
      "operator": "regex",
      "value": ".*\\.(exe|scr|bat|cmd|ps1|vbs|js)$"
    },
    {
      "field": "process_path",
      "operator": "contains",
      "value": "%TEMP%",
      "negate": true
    },
    {
      "field": "digital_signature",
      "operator": "not_exists"
    }
  ],
  "aggregation": {
    "type": "time_window",
    "size": 1,
    "unit": "minutes"
  },
  "actions": [
    {
      "type": "alert",
      "parameters": {
        "title": "Potential Malware Execution Detected",
        "message": "Suspicious process {{process_name}} executed by user {{username}} on {{hostname}}"
      }
    },
    {
      "type": "quarantine",
      "parameters": {
        "target": "file",
        "path": "{{process_path}}"
      },
      "delay": 5000
    },
    {
      "type": "block",
      "parameters": {
        "target": "process",
        "pid": "{{process_id}}"
      }
    }
  ],
  "metadata": {
    "category": "malware",
    "mitre_tactic": "Execution",
    "mitre_technique": "User Execution"
  }
}